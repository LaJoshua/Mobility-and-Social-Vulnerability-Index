# Install the packages (you only need to do this once)
# install.packages("plotly")
# install.packages("dplyr")
# install.packages("readr")
# install.packages("tidyverse")
install.packages("sf")


# Load the packages
library(plotly)
library(dplyr)
library(readr)
library(tidyverse)
library(sf)

states <- read.csv("/Users/joshuaharrell/Desktop/HPCintheCity/MSV/newstates.csv") %>%
  rename(State = state)

svi_df <- read.csv("/Users/joshuaharrell/Desktop/HPCintheCity/MSV/sviTraviscopy.csv") %>%
  left_join(states, by = 'State') %>%
  select(Zip,SVI,code)

load("/Users/joshuaharrell/Desktop/HPCintheCity/MSV/travisMapData.RData") 

sviplot <- travisMapData %>%
  left_join(svi_df %>% mutate(Zip = as.character(Zip)), by = "Zip") %>%
  ggplot(aes(geometry=geometry,fill=SVI),color="black")+
  scale_fill_gradient(low="cornsilk1", high="blue4", labels = scales::comma) +
  theme_void()+
  geom_sf()

ggsave(
  "/Users/joshuaharrell/Desktop/HPCintheCity/MSV/AustinSVIPlot.png",
  plot = sviplot,
  scale = 1,
  width = 6.5,
  height = 5.5 ,
  units = c("in"),
  dpi = 1200,
  bg = "white"
)
